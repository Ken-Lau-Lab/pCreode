# p-Creode

The term creode was coined by C.H. Waddington, combining the Greek words for “necessary” and “path” (Waddington, 1957) to describe the cell state transitional trajectories that define cell fate specification. Our algorithm aims to identify consensus routes from relatively noisy single-cell data and thus we named this algorithm p- (putative) Creode. Conceptually, p-Creode determines the geometric shape of a collection of dense data points (i.e., a data cloud) in order to reveal the underlying structure of transitional routes. The p-Creode algorithm consists of six steps. a) Down-sampling: a density-dependent down-sampling is performed to empirically normalize the representation of rare cell states with overrepresented ones (Qiu et al., 2011). b) Graph construction: a density-based k-nearest neighbor (d-kNN) graph is constructed using each data point representing a single cell as a node in the graph. The d-kNN graph is constructed by connecting each node with its k nearest neighbors, ranked by Euclidean distance, where k is determined by the relative density of cells in the neighborhood of each node. c) End-state identification: the graph attribute, closeness centrality, is used to identify end-states (stem or differentiated cell types). Closeness centrality is defined as the inverse sum of a node’s pairwise graph distances to all other nodes in the graph, where graph distance is the summed shortest path of weighted edge distances between two nodes. In p-Creode, nodes with high closeness represent transition states, while nodes with low closeness represent relatively end-states. End-states are then identified by K-means clustering of nodes with low closeness. The optimal cluster number (K), as determined by silhouette scoring (see Methods), is then doubled to allow representation of rare cell types. d) Topology reconstruction: a weighted topology is constructed using a novel hierarchical placement strategy of nodes within the paths between end-states (Figure S1). Unlike hierarchical clustering where all data points appear on the leaves of a dendrogram, this method places data points on branches to allow depiction of ancestral relationships. e) Consensus alignment: positions of nodes included in the topology are then aligned through iterative assignment and repositioning using all node positions, which determines “consensus routes” between end-states from all available data. f) Scoring: leveraging stochasticity generated by resampling, we obtain an ensemble of N topologies that is scored by a Gromov–Hausdorff-inspired scoring metric to depict the relative robustness of data in supporting the computed topology. This newly developed metric has general applicability outside of p-Creode to assess graphs with simultaneously differing node positions and connections.

